{% if block.size %}
  {% set blockClasses = block.size %}
{% else %}
  {% set blockClasses = "lg" %}
{% endif %}
{% if (block.width and block.height) and (block.height > block.width) %}
  {% if block.width / block.height < 0.34 %}
    {% set blockClasses = blockClasses + " extra-extra-tall" %}
  {% elif block.width / block.height < 0.5 %}
    {% set blockClasses = blockClasses + " extra-tall" %}
  {% elif block.width / block.height < 0.67 %}
    {% set blockClasses = blockClasses + " tall" %}
  {% else %}
    {% set blockClasses = blockClasses + " portrait" %}
  {% endif %}
{% endif %}
<div class="{{ blockClasses }}">
  <figure>
    {% if block.type == 'image' %}
      {% set image = block.filename | urlencode %}
      <img
        src="/media/{{ image }}"
        {% if block.alt %}alt="{{ block.alt }}"{% endif %}
        loading="lazy"
        {% if block.width %}width="{{ block.width }}"{% endif %}
        {% if block.height %}height="{{ block.height }}"{% endif %}
      >
    {% elif block.type == 'video' %}
      <video
        src="/media/{{ block.filename }}"
        playsinline
        {% if block.autoplay %}autoplay{% endif %}
        {% if block.loop %}loop{% endif %}
        {% if block.muted %}muted{% endif %}
        {% if block.controls %}controls{% endif %}
        {% if block.width %}width="{{ block.width }}"{% endif %}
        {% if block.height %}height="{{ block.height }}"{% endif %}
      ></video>
    {% endif %}
    {% if caption %}
      <figcaption>{{ caption | markdownify | safe }}</figcaption>
    {% endif %}
  </figure>
</div>